---
layout: default
---
<style>
table {width:100%;}
td {margin:0; padding:0; text-align: center;}
</style>
<div class="page">
  <h1 class="page-title">{{ page.title }}</h1>

{%- assign verse_spans = content | split: 'span id="v' -%}
  {%- assign verse_links = "" | split: "" -%}
  
  {%- for span in verse_spans offset:1 -%}
    {%- assign verse_num = span | split: '"' | first -%}

      {%- assign verse_links = verse_links | push: verse_num -%}
  {%- endfor -%}
  {%- if verse_links.size > 0 -%}
  <div class="verse-toc">
  <table>
  <tr>
  <td></td>
    {%- for verse in verse_links -%}
    {% assign remainder = forloop.index | modulo: 10 %}
  {% if remainder == 0 %}
    </tr><tr>
  {% endif %}
      <td><a href="#v{{ verse }}">{{ verse }}</a></td>
      
    {%- endfor -%}
   </tr>
   </table>
  </div>
  {%- endif -%}
  
  {%- assign processed_content = content -%}
  {%- assign tag_markers = content | split: '((' -%}
  
  {%- for marker in tag_markers offset:1 -%}
    {%- assign tag_content = marker | split: '))' | first | strip -%}
    {%- assign parts = tag_content | split: ',' -%}
    
    {%- if parts.size >= 2 -%}
      {%- assign ref = parts[0] | strip -%}
      {%- assign topic_links = "" -%}
      
      {%- for tag in parts offset:1 -%}
      {%- assign listcomma = "" -%}
      {%- if forloop.first == false -%}{%- assign listcomma = ", " -%}{%- endif -%}
        {%- assign tag_name = tag | strip -%}
        {%- assign tag_id = tag_name | downcase | replace: " ", "-" -%}
        {%- if topic_links != "" -%}
          {%- assign topic_links = topic_links | append: ' ' -%}
        {%- endif -%}
        {%- assign topic_links = topic_links | append: listcomma | append: '<a href="/quran/topics/#' | append: tag_id | append: '" class="topic-tag">' | append: tag_name | append: '</a>' -%}
      {%- endfor -%}
      
      {%- assign replacement = '<span class="topic-links">[Tags: ' | append: topic_links | append: ']</span>' -%}
      {%- assign original = '((' | append: tag_content | append: '))' -%}
      {%- assign processed_content = processed_content | replace: original, replacement -%}
    {%- endif -%}
  {%- endfor -%}
  
  {{ processed_content }}
  
</div>